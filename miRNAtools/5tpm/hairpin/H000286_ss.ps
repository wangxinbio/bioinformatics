%!PS-Adobe-3.0 EPSF-3.0
%%Creator: PS_dot.c,v 1.38 2007/02/02 15:18:13 ivo Exp $, ViennaRNA-1.8.0
%%CreationDate: Sat Apr  1 01:51:36 2017
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 66 210 518 662
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint coor length cutpoint sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
     coor exch 1 sub get aload pop moveto
     coor exch 1 sub get aload pop lineto
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  72 216 translate
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  72 6 mul size div dup scale
  size xmin sub xmax sub 2 div size ymin sub ymax sub 2 div
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
CAUCAUAUGGUGGAUUGUGUUGUUUUUCCACAAAAAGGGAAAAGGUAAGCAAGUUUAUUAUGUAUG\
) def
/coor [
[84.110 317.163]
[84.110 302.163]
[84.110 287.163]
[80.846 280.236]
[84.478 271.464]
[85.181 256.481]
[85.884 241.497]
[86.587 226.514]
[87.290 211.530]
[87.993 196.547]
[88.696 181.563]
[89.399 166.579]
[90.102 151.596]
[90.805 136.612]
[91.509 121.629]
[92.212 106.645]
[89.337 98.787]
[93.315 90.981]
[94.720 76.047]
[96.124 61.113]
[97.529 46.179]
[88.115 28.627]
[99.163 13.021]
[99.163 -1.979]
[99.163 -16.979]
[99.163 -31.979]
[99.163 -46.979]
[99.163 -61.979]
[99.163 -76.979]
[86.530 -85.991]
[81.639 -100.717]
[86.370 -115.495]
[98.904 -124.643]
[114.421 -124.643]
[126.955 -115.495]
[131.686 -100.717]
[126.795 -85.991]
[114.163 -76.979]
[114.163 -61.979]
[114.163 -46.979]
[114.163 -31.979]
[114.163 -16.979]
[114.163 -1.979]
[114.163 13.021]
[122.296 19.888]
[125.179 30.366]
[121.558 40.851]
[112.463 47.583]
[111.059 62.517]
[109.654 77.451]
[108.249 92.386]
[107.195 107.349]
[106.492 122.332]
[105.789 137.316]
[105.086 152.299]
[104.383 167.283]
[103.680 182.266]
[102.977 197.250]
[102.274 212.233]
[101.570 227.217]
[100.867 242.200]
[100.164 257.184]
[99.461 272.167]
[99.110 287.163]
[99.110 302.163]
[99.110 317.163]
] def
/pairs [
[1 66]
[2 65]
[3 64]
[5 63]
[6 62]
[7 61]
[8 60]
[9 59]
[10 58]
[11 57]
[12 56]
[13 55]
[14 54]
[15 53]
[16 52]
[18 51]
[19 50]
[20 49]
[21 48]
[23 44]
[24 43]
[25 42]
[26 41]
[27 40]
[28 39]
[29 38]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
